# VLAN Architecture & Tooling Matrix

## 1. VLAN Matrix

| VLAN-ID | Segment        | Subnet         | Trunk Profile | Purpose                | Design Principles         | Key Users                | Must Have Tools                  | Should Have Tools             | Could Have Tools             | ACL Policy / VACL    | Redundancy | Automation Status    | Integration & Automation (Tool)      |
|---------|---------------|----------------|---------------|------------------------|--------------------------|--------------------------|----------------------------------|-------------------------------|------------------------------|----------------------|------------|---------------------|---------------------------------------|
| 10      | Management    | 10.0.10.0/24   | Trunk-1       | Central management     | Least privilege, logging | Administrators           | Proxmox VE, OPNsense, Ansible     | NetBox, Zabbix, Keycloak      | OpenVAS, Monit               | Strict, deny-all     | Yes        | Fully automated      | NetBox + Ansible + Graylog           |
| 20      | DMZ           | 10.0.20.0/24   | Trunk-1       | External exposure      | Segregation, firewall    | External, admins         | Nginx, Caddy                      | Pangolin                      | Suricata                     | PVLAN + VACL         | Yes        | Partially automated  | OPNsense + Suricata + Graylog        |
| 30      | Prod-Servers  | 10.0.30.0/24   | Trunk-2       | Production apps        | Isolation, monitoring    | Users, admins            | Nextcloud, Postgres               | n8n, Supabase, OpenWebUI      | Ollama                       | Restrictive ACL       | Yes        | Fully automated      | Ansible + Graylog + Monit            |
| 40      | Prod-Storage  | 10.0.40.0/24   | Trunk-2       | Production storage     | Encryption, backup       | Servers, admins          | TrueNAS                           | OpenMediaVault                | rclone                       | Restrictive ACL       | Yes        | Fully automated      | TrueNAS + Proxmox Backup Server      |
| 50      | Workstations  | 10.0.50.0/24   | Trunk-3       | Workstations           | Segregation, NAC         | Employees                | -                                 | FreeRADIUS                    | PacketFence                   | Restrictive ACL       | Yes        | Fully automated      | FreeRADIUS + NetBox                  |
| 60      | IoT           | 10.0.60.0/24   | Trunk-4       | IoT isolation          | Minimal rights           | IoT devices, admins      | -                                 | Zeek                          | Suricata                      | Restrictive ACL       | Yes        | Partially automated  | Zeek + Graylog                       |
| 70      | Guest         | 10.0.70.0/24   | Trunk-4       | Guest access           | Guest isolation          | Guests                   | -                                 | OpenWRT                       | pfSense captive portal         | Restrictive ACL       | Yes        | Fully automated      | OpenWRT + Graylog                    |

---

## 2. Tool Priority Definitions

- **Must Have:** Essential for security, reliability, and management.
- **Should Have:** Highly recommended for easier management or scalability.
- **Could Have:** Nice-to-have features, not critical.

---

## 3. Key Concepts

- **VLAN:** Virtual LAN, segments network traffic.
- **Trunk Profile:** Which VLANs are allowed on a switch port.
- **PVLAN:** Private VLAN, extra segmentation inside a VLAN.
- **VACL:** VLAN Access Control List, controls traffic within/between VLANs.
- **NAC:** Network Access Control, manages who/what can join which VLAN.
- **Redundancy:** Multiple connections/devices to avoid single points of failure.
- **Automation Status:** Is provisioning, monitoring, and logging automated?

---

## 4. Integration & Automation

- **NetBox:** Asset inventory, integrates with Ansible for automation.
- **Ansible:** Automates configuration (switches, firewalls, VMs).
- **Graylog/ELK:** Centralizes logs and security alerts.
- **OPNsense:** Firewall, integrates with Suricata (IDS/IPS).
- **FreeRADIUS:** Assigns VLANs dynamically (NAC).
- **Proxmox Backup Server:** Automated VM/container backups.
- **Monit:** Monitors and restarts critical services.

---

## 5. Step-by-Step: Adding a New VLAN

1. Define purpose and users.
2. Assign VLAN-ID, subnet, trunk profile.
3. Update documentation (NetBox, matrix).
4. Configure devices (Ansible).
5. Set ACLs and security policies.
6. Integrate with monitoring/logging.
7. Test connectivity and access.

---

## 6. Security Checklist

- Use 802.1Q tagging for VLANs.
- Avoid reserved VLAN IDs (0, 1, 4095).
- Secure trunk ports (allow only needed VLANs).
- Regularly audit ACLs and segmentation.
- Use redundancy for uplinks/devices.
- Review logs and SIEM alerts often.

---

## 7. Best Practices

- Use Layer 3 switching for routing between VLANs.
- Standardize naming and numbering.
- Automate as much as possible.
- Centralize monitoring and documentation.
- Review and update matrix regularly.

---

*Last updated: 2025-05-26*
